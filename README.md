# Fertilization_ABM
This repository accompanies: 'Modeling Diffusive Search by Non-Adaptive Sperm: Empirical and Computational Insights' (https://www.biorxiv.org/content/10.1101/2024.06.17.599386v1)

The Programs consist of: 
Agent-based models written in the Netlogo programming language (V6.3.0)-
1. Figure 1- Simulation of random walks
2. Figure 2- Model used for movement function parameterization
3. Figure 3- Model used for measuring collective search properties of sperm populations with varying motility state proportions
4. Figure 4- Model used for drawing and saving maze environments. Includes folder of mazes used in the publication simulations (.txt files). Note: to load the mazes using corresponding ABMs, the maze file must be in the working directory, and must be named 'File IO PATCH DATA.txt'. To run using the .txt files in this repository, remove the additional file name text. For example, change File IO PATCH DATA_Maze_A.txt to File IO PATCH DATA.txt
5. Figure 6- Model used for measuring search time and efficiency for populations of sperm with Poisson distributed intracellular calcium oscillation frequencies.
6. Figure 7- Model used for generating tabular data for the Python analysis framework detailed below. 

Python (V3.9.10) scripts used for data analysis and modeling.
1. Markov_Transitions.ipynb- Jupyter notebook that demonstrates how the Markov transition table used in the study was generated.
2. Analysis framework for determining the posterior distribution and relative information gain (KL divergence) from .csv files containing simulation data written out from a Netlogo simulation.

Algorithmic design for the Analysis framework: 
file_correction.py -> simulation.py -> combine_columns.py -> combine_kl_columns.py

file_correction.py
This file filters through csv files generated by Netlogo Simulation from a directory and corrects the ones where two simulations were generated into one csv file instead of just one simulation per a csv file. It splits these csv files into two with one keeping the original file name and the other ending with “_5.csv”.  It takes in a directory as an argument. Use the file but running this into the command line:
python file_correction.py directory
This overwrites the file needing to be corrected and places the two corrected file back into the directory.  

simulation.py
This file retrieves the all csv files from the directory, filters the data, utilizes Bayes Theoreom, and KL Divergence, and exports the data into another CSV ending with “_results.csv”. It takes in a directory as an argument. Use the file but running this into the command line:
python simulation.py directory
This places the results file into the directory. 

combine_columns.py
This file retrieves all the result csv files generated from simulation.py from a directory and combines them to generate three csv files for all the Q', Likelihood, and Posterior results, which are all probabilities contributing in Bayes Theorem and also KL divergence. It takes in a directory as an argument. Use the file but running this into the command line:
python combine_columns.py directory
This places the csv files ending with “_Q.csv” , “_likelihood.csv”, and “_posterior.csv” into the directory

combine_kl_columns.py
This file retrieves all the result csv files generated from simulation.py from a directory and combines them to generate one csv file for all the KL divergences. It takes in a directory as an argument. Use the file but running this into the command line:
python combine_kl_columns.py directory
This places the csv file ending with “_kl_divergence.csv” onto the directory.
  
